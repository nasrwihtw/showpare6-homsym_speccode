(window["webpackJsonpPluginhomsym-import-c-s-v-speccode"]=window["webpackJsonpPluginhomsym-import-c-s-v-speccode"]||[]).push([[308],{943:function(){},308:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}}),n(970);let{Mixin:r}=Shopware;var o={template:'{% block base_content %}\n   <div class="csv-import-wrapper" style="max-width: 600px; margin: 2rem auto;">\n      <div class="card" style="box-shadow: 0 0 8px rgba(0,0,0,0.1); border-radius: 8px;">\n         <div class="card-header" style="background-color: #0d6efd; color: white; padding: 1rem; border-radius: 8px 8px 0 0;">\n            <h4 style="margin: 0; background-color: #0d6efd; color: white;">Import CSV File</h4>\n         </div>\n         <div class="card-body" style="padding: 1.5rem;">\n            <form @submit.prevent="onSubmit">\n               <div class="form-group" style="margin-bottom: 1rem;">\n                  <label for="csv_file" style="display: block; margin-bottom: 0.5rem;">Select CSV file:</label>\n                  <input type="file"\n                         id="csv_file"\n                         name="csv_file"\n                         accept=".csv"\n                         required\n                         @change="onFileChange"\n                         style="width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;">\n               </div>\n               <button type="submit"\n                       :loading="isLoading"\n                       style="background-color: #0d6efd; color: white; padding: 0.6rem 1.2rem; border: none; border-radius: 4px;">\n                  {{ isLoading ? `Import l\xe4uft... (${progress}%)` : \'Import CSV\' }}\n               </button>\n            </form>\n\n            <div v-if="parsedData.length" style="margin-top: 2rem;">\n               <h5>Preview:</h5>\n               <table style="width: 100%; border-collapse: collapse;">\n                  <thead>\n                  <tr>\n                     <th style="border: 1px solid #ccc; padding: 8px; background: #f0f0f0;">Product</th>\n                     <th style="border: 1px solid #ccc; padding: 8px; background: #f0f0f0;">Kategory</th>\n                     <th style="border: 1px solid #ccc; padding: 8px; background: #f0f0f0;">Speccode</th>\n                  </tr>\n                  </thead>\n                  <tbody>\n                  <tr v-for="(row, rowIndex) in parsedData.slice(1, 6)" :key="\'row-\' + rowIndex">\n                     <td v-for="(cell, colIndex) in row" :key="\'cell-\' + rowIndex + \'-\' + colIndex" style="border: 1px solid #ccc; padding: 8px;">\n                        {{ cell }}\n                     </td>\n                  </tr>\n                  </tbody>\n               </table>\n               <small>Showing first 5 rows...</small>\n            </div>\n            <div style="margin-top: 2rem ">\n               <h4> Nicht importierte Daten ({{ totalInvalidRowsCount }})</h4>\n               <p>Du Kannst nicht gefundene Produkt und Kategorien herunterladen</p>\n               <sw-button  style="background-color: #0d6efd; color: white; padding:0.1rem 1.5rem; margin-top: 0.7rem; border: none; border-radius: 4px;"\n                           @click="saveInvalidRowsToFile">Download</sw-button>\n            </div>\n         </div>\n      </div>\n   </div>\n{% endblock %}\n',mixins:[r.getByName("notification")],inject:["repositoryFactory","acl","notification"],data(){return{file:null,parsedData:[],isLoading:!1,progress:0,inValidBackendRows:[],totalInvalidRowsCount:0,myArray:[{name:"Alice",age:25},{name:"Bob",age:30}]}},methods:{onFileChange(e){this.file=e.target.files[0]},async onSubmit(){if(!this.file){this.createNotificationError({message:this.$tc("speccode.importcsv-speccode.noFile")});return}try{let e=(await this.file.text()).split(/\r?\n/).filter(e=>""!==e.trim()),t=this.parseCSVLine(e[0]),n=e.slice(1).map(e=>{let n=this.parseCSVLine(e),r={};return t.forEach((e,t)=>{r[e]=n[t]?n[t].trim():""}),r});this.parsedData=n,this.isLoading=!0,this.progress=0;let r=await Shopware.Service("syncService").httpClient.post("homsymimportcsvspecode/setspeccode",this.parsedData);r?.data?.failedItems?.length>0&&this.handleInvalidRows(r.data.failedItems),this.progress=100,this.createNotificationSuccess({message:this.$tc("speccode.importcsv-speccode.successUpload",this.parsedData.length)})}catch(e){console.error(e),this.createNotificationError({message:this.$tc("speccode.importcsv-speccode.errorUpload")})}finally{this.isLoading=!1,this.progress=100}},parseCSVLine(e){let t;let n=/(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|([^",;]+))(?:,|;)?/g,r=[];for(;t=n.exec(e);)r.push(t[1]?t[1].replace(/\"\"/g,'"'):t[2]);return r},handleInvalidRows(e){this.inValidBackendRows.push(...e),this.totalInvalidRowsCount+=e.length},saveInvalidRowsToFile(){let e=new Blob([this.inValidBackendRows.map(e=>Object.values(e).join(", ")).join("\n")],{type:"text/plain"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="NotFoundProdukteUndKategorien.txt",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}}}},970:function(e,t,n){var r=n(943);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(534).A)("336a8248",r,!0,{})},534:function(e,t,n){"use strict";function r(e,t){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],s=i[0],a={id:e+":"+o,css:i[1],media:i[2],sourceMap:i[3]};r[s]?r[s].parts.push(a):n.push(r[s]={id:s,parts:[a]})}return n}n.d(t,{A:function(){return m}});var o,i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var s={},a=i&&(document.head||document.getElementsByTagName("head")[0]),d=null,l=0,c=!1,p=function(){},u=null,h="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,t,n,o){c=n,u=o||{};var i=r(e,t);return g(i),function(t){for(var n=[],o=0;o<i.length;o++){var a=s[i[o].id];a.refs--,n.push(a)}t?g(i=r(e,t)):i=[];for(var o=0;o<n.length;o++){var a=n[o];if(0===a.refs){for(var d=0;d<a.parts.length;d++)a.parts[d]();delete s[a.id]}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t],r=s[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(b(n.parts[o]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{for(var i=[],o=0;o<n.parts.length;o++)i.push(b(n.parts[o]));s[n.id]={id:n.id,refs:1,parts:i}}}}function v(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function b(e){var t,n,r=document.querySelector("style["+h+'~="'+e.id+'"]');if(r){if(c)return p;r.parentNode.removeChild(r)}if(f){var o=l++;t=w.bind(null,r=d||(d=v()),o,!1),n=w.bind(null,r,o,!0)}else t=x.bind(null,r=v()),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){r?(r.css!==e.css||r.media!==e.media||r.sourceMap!==e.sourceMap)&&t(e=r):n()}}var y=(o=[],function(e,t){return o[e]=t,o.filter(Boolean).join("\n")});function w(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=y(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function x(e,t){var n=t.css,r=t.media,o=t.sourceMap;if(r&&e.setAttribute("media",r),u.ssrId&&e.setAttribute(h,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}}]);